# Архитектура проекта

## Структура проекта
- `main.py` - Главный файл проекта
- `workBitrix.py` - Функции для работы с Bitrix24 API
- `test.py` - Файл для тестирования
- `индивидуальный_расчет.docx` - Документ Word с расчетом
- `индивидуальный_расчет.pdf` - PDF версия документа с расчетом
- `индивидуальный_расчет.html` - HTML версия карточки товара с расчетом
- `hello_world.pdf` - Тестовый PDF файл
 - `insert_html_to_pdf.py` - Вставка HTML-страницы в существующий PDF
- `fonts/` - Директория с шрифтами
- `.venv/` - Виртуальное окружение Python
- `.env` - Файл с переменными окружения

## Описание файлов
- `main.py` - Основной скрипт, содержит главную логику приложения
  - `create_calculation_doc()` - Функция для генерации документов DOCX с расчетом
  - `create_calculation_html()` - Функция для генерации HTML-карточек товаров с расчетом
- `workBitrix.py` - Содержит функции для взаимодействия с API Bitrix24
- `индивидуальный_расчет.html` - HTML-версия карточки товара с индивидуальным расчетом, содержит таблицу с информацией о камне, его характеристиках, объеме, весе и цене
- `индивидуальный_расчет.docx` - Документ Word с аналогичной информацией
- `индивидуальный_расчет.pdf` - PDF документ с аналогичной информацией
 - `insert_html_to_pdf.py` - Скрипт, конвертирующий HTML в PDF и вставляющий страницу в базовый PDF
   - `insert_html_page_to_pdf()` - основная функция:
     - создает временную копию HTML, заменяя `image/jpg` на `image/jpeg`
     - декодирует все `data:image/*;base64` и транскодирует их в PNG через `Pillow`, затем подменяет на `data:image/png;base64`
     - конвертирует подготовленный HTML в PDF (`wkhtmltopdf` с `enable-local-file-access`, `encoding=utf-8`)
     - вставляет полученную страницу в `base_pdf_path` после `insert_after_page`

## Зависимости
- `fast_bitrix24` - Библиотека для работы с API Bitrix24
- `fpdf` - Библиотека для создания PDF-документов
- `python-docx` - Библиотека для работы с документами в формате docx
- `lxml` - Библиотека для работы с XML и HTML
- `Pillow` - Библиотека для работы с изображениями
- `python-dotenv` - Библиотека для загрузки переменных окружения из файла .env
- `tqdm` - Библиотека для создания прогресс-баров
- `loguru` - Библиотека для логирования 